<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jSQL">
	<select id="getInList" resultType="String">
		SELECT 
			INAME 
		FROM 
			INGREDIENT
	</select>
	
	<insert id="addRecipe" parameterType="jVO">
		<selectKey keyProperty="bno" resultType="int" order="BEFORE">
			(SELECT NVL(MAX(bno) + 1, 1001) FROM board)
		</selectKey>
		INSERT INTO
		    board(bno, bmno, tno, title, category, ingred, video, time, situat)
		VALUES(
		    #{bno},
		    (select mno from member where id= #{id}),
		    #{tno}, #{title}, #{category}, #{inbox}, #{video}, #{time}, #{situat}
		)
	</insert>
	
	<insert id="addThumb" parameterType="jtVO">
		<selectKey keyProperty="tno" resultType="int" order="BEFORE">
			SELECT
				NVL(MAX(tno) + 1, 1001)
			FROM
				thumb
		</selectKey>
		insert into
		    thumb(tno, dir, tname)
		values(
		    #{tno}, '/fri/img/thumb/', #{tname}
		)
	</insert>
	
	<insert id="addRecipeDetail" parameterType="jrVO">
		insert into
		    boardpart(
	    <if test="oriname != null">
		    	bpno, body, bno, oriname, savename, dir
	    </if>
	    <if test="oriname == null">
		    	bpno, body, bno
	    </if>
		    )
		values(
		<if test="oriname != null">
		    (select NVL(MAX(bpno) + 1, 1001) from boardpart),
		    #{body}, #{bno},
		    #{oriname}, #{savename}, '/fri/img/upload/'
		</if>	
		<if test="oriname == null">
		    (select NVL(MAX(bpno) + 1, 1001) from boardpart),
		    #{body}, #{bno}
		</if>
		)
	</insert>
	
	<!-- 
	<insert id="addRecipeDetailNoImage" parameterType="jrVO">
		insert into
		    boardpart(
		    	bpno, body, bno
		    )
		values(
		    (select NVL(MAX(bpno) + 1, 1001) from boardpart),
		    #{body}, #{bno}
		)
	</insert>
	 -->

	<select id="getThumb" resultType="String" parameterType="int">
		SELECT
			tname
		FROM
			thumb
		WHERE
			fisshow = 'Y'
			AND tno = #{tno}
	</select>
	
</mapper>