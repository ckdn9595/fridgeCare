<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="aSQL">
	<select id="getMemb" resultType="aVO" parameterType="String">
		SELECT
			id, (
				SELECT
					COUNT(*)
				FROM
					board
				WHERE
					bmno = mno
					) bcnt, condate, joindate
		FROM
			member m
			
		WHERE
			id = #{id}
	</select>
	
	<delete id="deleteThumb">
		DELETE FROM
		    thumb
		WHERE
		    tmno = #{mno}
	</delete>
	
	<delete id="deleteReply">
		DELETE FROM
		    reply
		WHERE
		    remno = #{mno}
	</delete>
	
	<select id="getBnoList" resultType="aVO" parameterType="int">
		SELECT
		    bno 
		FROM 
		    board 
		WHERE 
		    bmno = #{mno}
	</select>
	
	
	
	<select id="getLoginInfo" resultType="aVO">
		SELECT
		    m.id, m.mail
		FROM
		    member m, delinfo d
		WHERE
		    (TO_DATE(sysdate) - condate) > 365
		    AND m.isshow = 'Y'
		    AND m.id != d.id
	</select>
	
	<select id="getDelInfo" resultType="aVO">
		SELECT
		    id, mail
		FROM
		    delinfo 
		WHERE
		    (TO_DATE(sysdate) - deldate) >= 7
		    AND isshow = 'Y'
	</select>
	
	<insert id="addDelInfo" parameterType="aVO">
		INSERT INTO 
		    delinfo(dno, id, mail)
		VALUES(
		    (SELECT NVL(MAX(dno)+ 1, 1001) FROM delinfo), #{id}, #{mail}
		)
	</insert>
	
	<update id="setIsshow" parameterType="String">
		UPDATE
		    delinfo
		SET
		    isshow = 'N'
		WHERE
		    id = #{id}
	</update>
	
	
	<delete id="deleteBoardPart">
		DELETE FROM
		    boardpart
		WHERE
		    bno = #{bno}
	</delete>
	
	<delete id="deleteUserLike">
		delete from
		    userlike
		where
		    lmno = #{mno}
	</delete>
	<delete id="deleteLikeBno">
		delete from
		    userlike
		where
		    lbno = #{bno}
	</delete>
	<delete id="deleteBoardReply">
		delete from
		    reply
		where
		    rebno = #{bno} 
	</delete>
	<delete id="deleteBoard">
		DELETE FROM
		    board
		WHERE
		    bmno = #{mno}
	</delete>
	<delete id="deleteMemb">
		DELETE FROM
		    member
		WHERE
		    mno = #{mno}
	</delete>
</mapper>